PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
DROP TABLE tag;
DROP TABLE nd;
DROP TABLE member;
DROP TABLE admin;
DROP TABLE neighbor;
DROP TABLE relation;
DROP TABLE way;
DROP TABLE node;
DROP TABLE bound;
CREATE TABLE node (id long primary key,lat double not null,lon double not null, version integer not null,processed boolean default false, temporary boolean default false);
CREATE TABLE tag (id long not null,k varchar not null,v varchar not null, primary key (id,k));
CREATE TABLE way (id long primary key,version integer not null,processed boolean default false, temporary boolean default false);
CREATE TABLE relation (id long primary key,version integer not null,processed boolean default false);
CREATE TABLE nd (id long references way(id) on delete cascade not null,seq integer not null,ref long not null references node(id) on delete cascade,primary key (id,seq));
CREATE TABLE member (id long not null references relation(id) on delete cascade,seq integer not null,type varchar not null,ref long not null, role varchar, primary key (id,seq));
CREATE TABLE neighbor (id1 long not null references node(id) on delete cascade,id2 long not null references node(id) on delete cascade, way long not null references way(id) on delete cascade,distance double default NULL,primary key(id1,id2));
CREATE TABLE bound (minlat double not null,maxlat double not null,minlon double not null, maxlon double not null,processed boolean default false);
CREATE TABLE admin (id long not null references relation(id) on delete cascade,level integer,name varchar,type varchar not null,minlat double not null,maxlat double not null,minlon double not null, maxlon double not null);
CREATE TRIGGER nodetag BEFORE DELETE ON node FOR EACH ROW  BEGIN DELETE FROM tag where id=old.id; DELETE FROM member where ref=old.id; END;
CREATE TRIGGER waytag BEFORE DELETE ON way FOR EACH ROW  BEGIN DELETE FROM tag where id=old.id; DELETE FROM member where ref =old.id; END;
CREATE TRIGGER reltag BEFORE DELETE ON relation FOR EACH ROW  BEGIN DELETE FROM tag where id=old.id; END;
COMMIT;
PRAGMA foreign_keys=ON;